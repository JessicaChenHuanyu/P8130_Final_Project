---
title: "**P8130 Final Report (Project 1)**"
author: 
- "Huanyu Chen (hc3451)"
- "Xiaoting Tang (xt2288)"
- "Yifei Liu (yl5508)"
- "Longyu Zhang (lz2951)"
date: "2023-12-16"
output:
  pdf_document:
    latex_engine: pdflatex
fontsize: 12pt
geometry: margin=1in
linestretch: 2
---

```{r, include=FALSE}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(tidyr)
library(knitr)
library(MASS)
library(glmnet)
library(leaps)

set.seed(1)
```

not exceed 5 pages

# Abstract

(condenses a brief introduction, brief description of methods, and main results into a one-paragraph summary)

# Introduction
This study aims to predict student performance in math, reading, and writing using regression models. The study aims to identify the factors that influence academic success by exploring various variables, including personal characteristics such as gender, ethnicity, and parental education, as well as environmental factors like lunch type, test preparation, and weekly study hours. Additionally, the study aims to identify potential correlations between scores in different subjects. The study aims to provide educators and policymakers with practical insights to customize interventions, improve educational programs, and establish strong support structures that promote comprehensive academic progress among students by combining these analyses.


# Methods
This dataset contains information about students in a public school, including three test scores and various personal and socioeconomic factors. To aid analysis, categorical data has been converted into numerical representations based on their ordial order. To handle missing cells, the mean for each column is computed, and missing cells are replaced with the mean for that column in order to keep other variables still available to use in the regression model. This process ensures a more complete and representative dataset for further analysis.

After processing the data, we constructed a comprehensive descriptive table (**Table 1**) that summarizes key statistical measures of this dataset, providing a snapshot of central tendencies and variability. Then the distribution of the three response variables (test scores) is presented in **Figure 1**, indicating an approximate normal distribution.

- in diagnostics, all linear
- no transformation needed for all three
- no ouliters showed in plot, but for influential points
- multicollinearity checked. no correlated variables, VIF all small

- two models created for each response. one backward (better compared to forward), one lasso


# Results

- final model for each test score
- analyze between models

# Conclusions/Discussion


# Contribution

Xiaoting Tang: Method

Yifei Liu: Result Display

Longyu Zhang: Interpretation

Huanyu Chen: Writing

# Appendix
## Table
```{r echo = FALSE}
data =
  read_csv("./data.csv") |>
  janitor::clean_names() |>
  mutate(
    gender = factor(case_when(
      gender == "male" ~ 0,
      gender == "female" ~ 1,
      )),
    ethnic_group = factor(case_when(
      ethnic_group == "group A" ~ 0,
      ethnic_group == "group B" ~ 1,
      ethnic_group == "group C" ~ 2,
      ethnic_group == "group D" ~ 3,
      ethnic_group == "group E" ~ 4,
      )),
    parent_educ = factor(case_when(
      parent_educ == "some highschool" ~ 0,
      parent_educ == "some college" ~ 1,
      parent_educ == "associate's degree" ~ 2,
      parent_educ == "bachelor's degree" ~ 3,
      parent_educ == "master's degree" ~ 4,
      )),
    lunch_type = factor(case_when(
      lunch_type == "standard" ~ 0,
      lunch_type == "free/reduced" ~ 1,
      )),
    test_prep = factor(case_when(
      test_prep == "none" ~ 0,
      test_prep == "completed" ~ 1,
      )),
    parent_marital_status = factor(case_when(
      parent_marital_status == "married" ~ 0,
      parent_marital_status == "single" ~ 1,
      parent_marital_status == "widowed" ~ 2,
      parent_marital_status == "divorced" ~ 3,
      )),
    practice_sport = factor(case_when(
      practice_sport == "never" ~ 0,
      practice_sport == "sometimes" ~ 1,
      practice_sport == "regularly" ~ 2,
      )),
    is_first_child = factor(case_when(
      is_first_child == "no" ~ 0,
      is_first_child == "yes" ~ 1,
      )),
    transport_means = factor(case_when(
      transport_means == "school_bus" ~ 0,
      transport_means == "private" ~ 1,
      )),
    wkly_study_hours = factor(case_when(
      wkly_study_hours == "< 5" ~ 0,
      wkly_study_hours == "10-May" ~ 1,
      wkly_study_hours == "> 10" ~ 2,
      ))
    ) |>
  mutate(nr_siblings = factor(nr_siblings))

'
# Deal with NA -- Calculate the column mean (round to integer) and plug it into NA cell
column_means <- round(colMeans(data, na.rm = TRUE), digits = 0)
for (col in names(data)) {
  data[[col]][is.na(data[[col]])] <- column_means[col]
  }

head(data)
'

# Another data set for EDA
data_long <- data |>
  pivot_longer(cols = c(math_score, reading_score, writing_score),
               names_to = "test", values_to = "score")
```


```{r echo = FALSE}
# Summary
sum_data_fct =
  data |>
  dplyr::select(1:11) |>
  skimr::skim() |>
  dplyr::select(skim_variable, n_missing, complete_rate, factor.n_unique, factor.top_counts)

colnames(sum_data_fct) = c("Variable", "Missing", "Complete Rate", "Unique", "Top Counts")

knitr::kable(x = sum_data_fct, caption = "Categorical Variables pre-analysis", digits = 1)

data =
  data |>
  drop_na()
```

## Figure
```{r echo=FALSE, fig.align='center'}
# Boxplots
ggplot(data_long, aes(x = test, y = score, fill = test)) +
  geom_boxplot() +
  labs(title = "Figure 1: Scores Distribution (Boxplot)", x = "Test Type", y = "Score") +
  facet_wrap(~ test, scales = "free") +
  scale_fill_manual(values = c("skyblue", "salmon", "lightgreen")) +
  theme(plot.title = element_text(hjust = 0.5))
```

Analytical questions (you may only answer some of them but properly addressing more will improve the rate of your report):
1. Using variables 1-11 as the covariates to predict Math, Reading and Writing scores.
2. Which factors (features) affect each test score signficantly? Are there interacting effects?
3. Are the optimal prediction models similar or different across the three test scores? Is it possible to leverage one score as the auxiliary information to learn the model for another score (still its model against variables 1-11) better?


describe your final model and interpret its parameters. 
examine the marginal distributions and pairwise relationships between variables (e.g., nonlinearities)
explore several candidate models, and explain why you selected your model.
be clear about your motivation for carrying out certain analyses. 
Your report should include a table summarizing parameter estimates associated with your final fitted model, characterizing predictor variables.
• Data exploration: descriptive statistics and visualization.
• In your regression model, be watchful for variables that are highly correlated and be selective in the variables you will include in your analysis.
selective interactions between variables.


Grading:
Method and interpretation:
Understand the background and task of the project;
Preprocess of the data;
Proper choice and decision on models’ assumption, specification, diagnostic, selection, comparison, and validation;
Strategies and reasons of your designs and decisions should be included.
Correct and informative interpretation of the results.

Writing and result display:
Well-organized report with professional writing and structuring;
Proper introduction of the method with helpful and informative explanations;
Display the data and analysis results with tables and plots. 
Be concise and avoid displaying redundant or useless results; 
Do not exceed the page limit.
